set /A exitcode = 0

for /r %%i in (*.sln) do (
    dotnet build %%i --nologo --consoleLoggerParameters:NoSummary -v:q
    if errorlevel 0 (
        dotnet test %%i --no-build --nologo --consoleLoggerParameters:ErrorsOnly -v:q
        if errorlevel 0 (
            echo - %%~ni: test passed
        ) else (
            echo - %%~ni: test failed
            set /A %exitcode% = 1
        )
    ) else (
        echo - %%~ni: build failed
        set /A %exitcode% = 1
    )
)
exit %exitcode%
